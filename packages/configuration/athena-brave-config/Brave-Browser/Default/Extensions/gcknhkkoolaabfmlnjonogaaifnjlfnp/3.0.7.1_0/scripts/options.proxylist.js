function saveProxies(a){bg.foxyProxy.updateSettings({proxyList:a},"options",function(b){b.proxyList&&(a=b.proxyList),bg.foxyProxy.applyState(),onTabShow("")}),chrome.runtime.sendMessage({trackEvent:{category:"Proxies",action:"save"}})}function toggleselectedProxy(){selectedProxy=oTable.fnGetSelectedPosition(),null===selectedProxy?($("#proxylistMoveUp").button("option","disabled","disabled"),$("#proxylistMoveDown").button("option","disabled","disabled"),$("#proxylistDelete, #proxylistCopy, #proxylistEdit").button("option","disabled","disabled")):($("#proxylistMoveUp").button("option","disabled",0===selectedProxy||selectedProxy==list.length-1),$("#proxylistMoveDown").button("option","disabled",selectedProxy==list.length-2||selectedProxy==list.length-1),$("#proxylistDelete, #proxylistCopy").button("option","disabled",selectedProxy==list.length-1),$("#proxylistEdit").button("option","disabled",""))}function addNewProxy(a){var b=null;if(a){if(!a.domain||!a.port)return alert(chrome.i18n.getMessage("error_host_port_cannot_be_determined")),void 0;b=new Proxy({host:a.domain,port:a.port})}else b=new Proxy;list.splice(list.length-1,0,b),selectedProxy=list.length-2,proxyLoad(b)}function editProxy(){selectedProxy=oTable.fnGetSelectedPosition(),proxyLoad(list[selectedProxy],!0)}function updateProxyTable(a){oTable.fnClearTable(),list&&list.length&&oTable.fnAddData(list),"undefined"!=typeof a&&oTable.fnSelectRow(a),toggleselectedProxy()}function deleteSelectedProxy(){selectedProxy=oTable.fnGetSelectedPosition(),deleteProxy(selectedProxy)}function deleteDefaultProxy(){var a;for(a=list.length-1;a>=0;a--)"Default"==list[a].data.name&&deleteProxy(a,!0)}function deleteProxy(a,b){b=b||!1,(!list[a].data.readonly||list[a].data.readonly&&b)&&(list.splice(a,1),list.length<=1&&(chrome.extension.getBackgroundPage().foxyProxy._settings.enabledQA=!1),saveProxies(list),updateProxyTable())}function copySelectedProxy(){selectedProxy=oTable.fnGetSelectedPosition(),"number"==typeof selectedProxy&&selectedProxy>=0&&!list[selectedProxy].data.readonly&&(list.splice(selectedProxy,0,new Proxy(list[selectedProxy],!0)),saveProxies(list),updateProxyTable(selectedProxy))}function moveSelectedProxyUp(){if(selectedProxy=oTable.fnGetSelectedPosition(),selectedProxy>0){var a=list[selectedProxy-1];list[selectedProxy-1]=list[selectedProxy],list[selectedProxy]=a,saveProxies(list),updateProxyTable(selectedProxy-1)}}function moveSelectedProxyDown(){if(selectedProxy=oTable.fnGetSelectedPosition(),selectedProxy<list.length-1){var a=list[selectedProxy+1];list[selectedProxy+1]=list[selectedProxy],list[selectedProxy]=a,saveProxies(list),updateProxyTable(selectedProxy+1)}}function proxyLoad(a,b){if($("input[name='proxyType'][value='"+a.data.type+"']").setChecked(!0).click(),$("#proxyHost").val(a.data.host),$("#proxyPort").val(a.data.port),$("#proxyIsSocks").setChecked(a.data.isSocks),$("input[name='proxySocks'][value='"+a.data.socks+"']").setChecked(!0),$("#proxyEnabled").setChecked(a.data.enabled).prop("disabled",a.data.readonly?!0:!1),$("#proxyName").val(a.data.name).prop("disabled",a.data.readonly?!0:!1),$("#proxyNotes").val(a.data.notes.replace("<","&lt;","gm").replace(">","&gt;","gm")).prop("disabled",a.data.readonly?!0:!1),$("#proxyCycle").setChecked(a.data.cycle),$("#proxyDNS").setChecked(a.data.useDns),$("#proxyConfigUrl").val(a.data.configUrl).prop("disabled",a.data.readonly?!0:!1),$("#proxyNotifLoad").setChecked(a.data.notifOnLoad).prop("disabled",a.data.readonly?!0:!1),$("#proxyNotifError").setChecked(a.data.notifOnError).prop("disabled",a.data.readonly?!0:!1),$("#proxyPACReload").setChecked(a.data.reloadPAC).prop("disabled",a.data.readonly?!0:!1),$("#proxyPACInterval").val(a.data.reloadPACInterval).prop("disabled",a.data.readonly?!0:!1),$("#proxyPatterns * input[type='button']"),$("#configUrlPanel input[type='button']"),$("#proxyLogin").val(list[selectedProxy].data.login),$("#proxyPass").val(list[selectedProxy].data.pass),$("input[name='proxyType']:checked").click(),sProxyColor=a.data.color,$("#proxyColor").ColorPickerSetColor(sProxyColor),$("#proxyColor div").css("backgroundColor",sProxyColor),"Basic"!=foxyProxy.getFoxyProxyEdition()?(oPatternTable.fnClearTable(),a.data.patterns&&a.data.patterns.length&&oPatternTable.fnAddData(a.data.patterns),!a.data.readonly||2!=$("#tabs").tabs("option","selected")&&3!=$("#tabs").tabs("option","selected")||$("#tabs").tabs("select",1),$("#proxyPatternsLink").css("display",a.data.readonly?"none":"block"),$("#proxyIpPatternsLink").css("display",a.data.readonly?"none":"block")):$("#proxyPatternsLink").hide(),a.data.credentials){console.log("proxyLoad getting credentials for proxy: "+a.data.name);var c=foxyProxy.getCredentials(a);$("input[name='username']").val(c.username),$("input[name='password']").val(c.password),$("input[name='passwordConfirm']").val(c.password),$("#authBox").css("opacity",1),$("#authCheck").setChecked(!0)}else $("input[name='username']").val(""),$("input[name='password']").val(""),$("input[name='passwordConfirm']").val(""),$("#authBox").css("opacity",.3),$("#authCheck").setChecked(!1);$("#authCheck").on("change",function(){foxyProxy._settings.noAuthWarn?$(this).is(":checked")?($("#authBox").css("opacity",1),$("#authCheck").setChecked(!0),$(this).dialog("close")):$("#authBox").css("opacity",.3):($("#hint_auth_1").text(chrome.i18n.getMessage("hint_auth_1")),$("#hint_auth_2").text(chrome.i18n.getMessage("hint_auth_2")),$("#hint_auth_3").text(chrome.i18n.getMessage("hint_auth_3")),$("#authWarningDlg").dialog({modal:!0,width:"500px",resizable:!1,buttons:[{text:"OK",click:function(){$("input[name='noAuthWarn']").is(":checked")&&(foxyProxy._settings.noAuthWarn=!0,foxyProxy.updateSettings({settings:foxyProxy._settings})),$("#authBox").css("opacity",1),$("#authCheck").setChecked(!0),$(this).dialog("close")}},{text:"Cancel",click:function(){$(this).dialog("close")}}]}))}),$("#proxyEditDlg").dialog({title:chrome.i18n.getMessage("FoxyProxy")+" - "+chrome.i18n.getMessage("proxy_settings"),modal:!0,width:"800px",resizable:!1,close:function(){b?updateProxyTable():deleteProxy(selectedProxy)},buttons:[{text:chrome.i18n.getMessage("Save"),click:function(){var a,c,d,e,f;if("manual"==$("input[name='proxyType']:checked").val()&&(""==$("#proxyHost").val()||""==$("#proxyPort").val()))return alert(chrome.i18n.getMessage("error_no_hostname_or_ip")),void 0;if("auto"==$("input[name='proxyType']:checked").val()&&!RegExp("^\\d*$").test($("#proxyPACInterval").val()))return alert(chrome.i18n.getMessage("error_non_integer_interval")),void 0;if("auto"==$("input[name='proxyType']:checked").val()&&(a=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,!a.test($("#proxyConfigUrl").val())))return alert(chrome.i18n.getMessage("error_invalid_proxy_config_url")),void 0;if(""==$("#proxyName").val())if(c=$("input[name='proxyType']:checked").val(),"manual"==c)$("#proxyName").val($("#proxyHost").val()+":"+$("#proxyPort").val());else for(d=0,e=!0;e;){d++,f="New Proxy",d>1&&(f+=" ("+d+")"),e=!1;for(var g in list)if(list[g].data.name==f){e=!0;break}e||$("#proxyName").val(f)}return list[selectedProxy].data.enabled=$("#proxyEnabled").is(":checked"),list[selectedProxy].data.cycle=$("#proxyCycle").is(":checked"),list[selectedProxy].data.useDns=$("#proxyDNS").is(":checked"),list[selectedProxy].data.isSocks=$("#proxyIsSocks").is(":checked"),list[selectedProxy].data.notifOnLoad=$("#proxyNotifLoad").is(":checked"),list[selectedProxy].data.notifOnError=$("#proxyNotifError").is(":checked"),list[selectedProxy].data.reloadPAC=$("#proxyPACReload").is(":checked"),list[selectedProxy].data.name=$("#proxyName").val().replace("<","&lt;","gm").replace(">","&gt;","gm"),list[selectedProxy].data.notes=$("#proxyNotes").val().replace("<","&lt;","gm").replace(">","&gt;","gm"),list[selectedProxy].data.type=$("input[name='proxyType']:checked").val(),list[selectedProxy].data.socks=$("input[name='proxySocks']:checked").val(),list[selectedProxy].data.host=$("#proxyHost").val(),list[selectedProxy].data.port=$("#proxyPort").val(),list[selectedProxy].data.configUrl=$("#proxyConfigUrl").val(),list[selectedProxy].data.reloadPACInterval=$("#proxyPACInterval").val(),list[selectedProxy].data.color=sProxyColor,$("input[name='password']").val()!=$("input[name='passwordConfirm']").val()?(alert("Passwords do not match."),!1):(foxyProxy.setCredentials(list[selectedProxy],$("input[name='username']").val(),$("input[name='password']").val()),"auto"==$("input[name='proxyType']:checked").val()&&list[selectedProxy].updatePAC(),saveProxies(list),b=!0,$(this).dialog("close"),void 0)}},{text:chrome.i18n.getMessage("Cancel"),click:function(){$(this).dialog("close")}}]})}function addNewPattern(){list[selectedProxy].data.patterns.push(new ProxyPattern),selectedPattern=list[selectedProxy].data.patterns.length-1,patternLoad(list[selectedProxy].data.patterns[selectedPattern])}function editPattern(){selectedPattern=oPatternTable.fnGetSelectedPosition(),patternLoad(list[selectedProxy].data.patterns[selectedPattern],!0)}function updatePatternTable(a){oPatternTable.fnClearTable(),list[selectedProxy].data.patterns&&list[selectedProxy].data.patterns.length&&oPatternTable.fnAddData(list[selectedProxy].data.patterns),"undefined"!=typeof a&&oPatternTable.fnSelectRow(a)}function deleteSelectedPattern(){selectedPattern=oPatternTable.fnGetSelectedPosition(),null!==selectedPattern&&(list[selectedProxy].data.patterns.splice(selectedPattern,1),updatePatternTable())}function copySelectedPattern(){console.log(selectedPattern),selectedPattern=oPatternTable.fnGetSelectedPosition(),console.log(selectedPattern),"number"==typeof selectedPattern&&selectedPattern>=0&&(list[selectedProxy].data.patterns.splice(selectedPattern,0,new ProxyPattern(list[selectedProxy].data.patterns[selectedPattern])),updatePatternTable(selectedPattern))}function openPacViewDlg(){$("#proxyConfigUrl").val()&&$.ajax({url:$("#proxyConfigUrl").val(),cache:!1,error:function(a,b,c){alert(chrome.i18n.getMessage("PAC_file_error")+": "+b+" "+(c?c:""))},success:function(a){console.log(a),$("#pacViewDlgText").val(a),$("#pacViewDlg").dialog({width:"520px",title:chrome.i18n.getMessage("appName")+" - "+chrome.i18n.getMessage("PAC_View"),modal:!0})}})}function testPac(){$("#proxyConfigUrl").val()&&$.ajax({url:$("#proxyConfigUrl").val()+"?rnd="+Math.random(),cache:!1,error:function(a,b,c){alert(chrome.i18n.getMessage("PAC_file_error")+": "+b+" "+(c?c:""))},success:function(a){var b=document.getElementById("testPacFrame"),c={command:"test",script:a};b.contentWindow.postMessage(c,"*")}})}function patternLoad(a,b){$(".modeAdd").show(),$(".modeQuickAdd").hide(),$("#patternEnabled").setChecked(a.data.enabled),$("#patternTemporary").setChecked(a.data.temp),$("#patternName").val(a.data.name.replace("<","&lt;","gm").replace(">","&gt;","gm")),$("#patternUrl").val(a.data.url.replace("<","&lt;","gm").replace(">","&gt;","gm")),$("input[name='patternWhitelist'][value='"+a.data.whitelist+"']").setChecked(!0),$("input[name='patternType'][value='"+a.data.type+"']").setChecked(!0),$("#patternEditDlg").dialog({title:chrome.i18n.getMessage("appName")+" - "+chrome.i18n.getMessage("add_edit_pattern"),modal:!0,width:500,resizable:!1,close:function(){b||list[selectedProxy].data.patterns.splice(selectedPattern,1)},buttons:[{text:chrome.i18n.getMessage("Save"),click:function(){if(""==$("#patternUrl").val())alert(chrome.i18n.getMessage("Pattern URL must be specified"));else{var c=list[selectedProxy].data.patterns;c[selectedPattern].data.enabled=$("#patternEnabled").is(":checked"),c[selectedPattern].data.temp=$("#patternTemporary").is(":checked"),c[selectedPattern].data.name=$("#patternName").val().replace("<","&lt;","gm").replace(">","&gt;","gm"),c[selectedPattern].data.url=$("#patternUrl").val().replace("<","&lt;","gm").replace(">","&gt;","gm"),c[selectedPattern].data.whitelist=$("input[name='patternWhitelist']:checked").val(),c[selectedPattern].data.type=$("input[name='patternType']:checked").val(),!b&&patternDuplicates(c,a)&&(c.splice(selectedPattern,1),alert(chrome.i18n.getMessage("error_duplicate_pattern"))),updatePatternTable(),oPatternTable.fnSelectRow(selectedPattern),b=!0,$(this).dialog("close")}}},{text:chrome.i18n.getMessage("Cancel"),click:function(){$(this).dialog("close")}}]})}function patternDuplicates(a,b){return duplicate=!1,$.each(a,function(a,c){c!=b&&c.data.url==b.data.url&&(duplicate=!0)}),duplicate}function addPattern(a){chrome.runtime.getBackgroundPage(function(b){bg=b;var c=bg.foxyProxy;c.getSettings(function(b){var d=b.settings;return d.enabledQA?($(".modeAdd").hide(),$(".modeQuickAdd").show(),$("#patternPageUrl").val(a).change(function(a){$("#patternUrl").val(genPattern(a.target.value,d.patternTemplateQA))}).change(),$("#dialogPatternProxyQA *").remove(),c.getProxyList(function(a){var b=a.proxyList;$.each(b,function(a,b){b.data.readonly||$("#dialogPatternProxyQA").append($('<option value="'+a+'">'+b.data.name+"</option>"))}),$("#dialogPatternProxyQA option[value='"+d.patternProxyQA+"']").attr("selected","selected"),$("#dialogPatternProxyQA").change(),$("#patternEditDlg").dialog({title:chrome.i18n.getMessage("appName")+chrome.i18n.getMessage("quickAdd"),width:"500px",modal:!0,buttons:[{text:chrome.i18n.getMessage("okay"),click:function(){selectedProxy=d.patternProxyQA;var a=!1,c=$("#patternUrl").val();$.each(b[selectedProxy].data.patterns,function(b,d){d.data.url==c&&(a=!0)}),a||(b[selectedProxy].data.patterns.push(new ProxyPattern),selectedPattern=b[selectedProxy].data.patterns.length-1,b[selectedProxy].data.patterns[selectedPattern].data.enabled=!0,b[selectedProxy].data.patterns[selectedPattern].data.temp=d.patternTemporaryQA,b[selectedProxy].data.patterns[selectedPattern].data.name=d.patternNameQA,b[selectedProxy].data.patterns[selectedPattern].data.url=c,b[selectedProxy].data.patterns[selectedPattern].data.whitelist=d.patternWhitelistQA,b[selectedProxy].data.patterns[selectedPattern].data.type=d.patternTypeQA,saveProxies(b)),$(this).dialog("close")}},{text:chrome.i18n.getMessage("Cancel"),click:function(){$(this).dialog("close")}}]}).parent().find(".ui-dialog-buttonset").css({width:"100%","text-align":"right"})}),void 0):(d.enabledQA=!1,alert(chrome.i18n.getMessage("QuickAdd_disabled")),void 0)})})}function saveSettings(){console.log("saveSettings"),foxyProxy.updateSettings({settings:settings})}function genPattern(a,b,c){var d=c?"gi":"g",e=parseUri(a);e.hostport=e.domain?e.domain+(e.port?":"+e.port:""):"",e.prePath=(e.protocol?e.protocol+"://":"")+e.authority;var f=b.replace("${0}",e.protocol?e.protocol:"",d);return f=f.replace("${1}",e.user?e.user:"",d),f=f.replace("${2}",e.password?e.password:"",d),f=f.replace("${3}",e.userInfo?e.userInfo+"@":"",d),f=f.replace("${4}",e.domain?e.domain:"",d),f=f.replace("${5}",e.port?e.port:"",d),f=f.replace("${6}",e.hostport?e.hostport:"",d),f=f.replace("${7}",e.prePath?e.prePath:"",d),f=f.replace("${8}",e.directory?e.directory:"",d),f=f.replace("${9}",e.file?e.file:"",d),f=f.replace("${10}",e.file?e.file:"",d),f=f.replace("${11}",e.file?e.file:"",d),f=f.replace("${12}",e.path?e.path:"",d),f=f.replace("${13}",e.anchor?e.anchor:"",d),f=f.replace("${14}",e.query?e.query:"",d),f=f.replace("${15}",e.source?e.source:"",d)}function onTabShow(a){console.log("tagName is",a),lastTabName=a,a&&$("#"+a).show(),chrome.runtime.getBackgroundPage(function(a){foxyProxy=a.foxyProxy,foxyProxy.getSettings(),foxyProxy.getProxyList()}),chrome.runtime.sendMessage({trackEvent:{category:"Options",action:"tabShow",label:"tabName",value:a}})}function exportConfig(){var a=chrome.extension.getBackgroundPage().foxyProxy.settingsToXml();chrome.extension.getBackgroundPage().foxyProxy.saveToFile(a)}var selectedProxy=-1,oTable,list=null,bg=null,isProxyTableInitialized=!1;chrome.runtime.onMessage.addListener(function(a){if(a.proxyList&&a.proxyList.length>0){list=a.proxyList.map(function(a){return new Proxy(a)});var b=$("#proxyModeGlobal");b.empty(),"Basic"!==foxyProxy.getFoxyProxyEdition()&&$('<option value="auto">'+chrome.i18n.getMessage("mode_patterns_label")+"</option>").appendTo(b),$.each(list,function(a,c){if(c.data.enabled){$("<option value='"+c.data.id+"'>"+chrome.i18n.getMessage("mode_custom_label",c.data.name)+"</option>").appendTo(b)}}),$('<option value="disabled">Disable FoxyProxy</option>').appendTo(b),$("option[value='"+bg.foxyProxy.state+"']",b).attr("selected","selected"),isProxyTableInitialized?updateProxyTable():initProxyList()}}),chrome.runtime.getBackgroundPage(function(a){bg=a;var b=bg.foxyProxy;b.getProxyList()});var initProxyList=function(){console.log("initProxyList"),$(".listManupualtionButtons > button").css("width","150px"),$("button").button().css({"text-align":"left"}),oTable=$("#proxyList").dataTable({bPaginate:!1,bLengthChange:!1,bFilter:!1,bSort:!1,bInfo:!1,bAutoWidth:!1,bUseRendered:!1,aaData:list,oLanguage:{sZeroRecords:""},aoColumns:[{bVisible:!1},{sTitle:chrome.i18n.getMessage("Enabled"),bUseRendered:!1,fnRender:function(a){return a.aData[a.iDataColumn]?"<img src='styles/images/bullet_tick.png'>":""}},{sTitle:chrome.i18n.getMessage("Color"),bUseRendered:!1,fnRender:function(a){var b=a.aData[a.iDataColumn];return"<span class='colorbox' style='background-color: "+b+"'></span>"}},{sTitle:chrome.i18n.getMessage("proxy_name")},{sTitle:chrome.i18n.getMessage("proxy_notes")},{sTitle:chrome.i18n.getMessage("Host_or_IP_Address")},{sTitle:chrome.i18n.getMessage("port")},{sTitle:chrome.i18n.getMessage("is_SOCKS_proxy"),bUseRendered:!1,fnRender:function(a){return a.aData[a.iDataColumn]?"<img src='styles/images/bullet_tick.png'>":""}},{sTitle:chrome.i18n.getMessage("SOCKS_Version")},{sTitle:chrome.i18n.getMessage("Auto_PAC_URL")}]}),$("#proxyList tbody tr").live("click",function(){oTable.fnSelect(this),toggleselectedProxy()}).first().click(),$("#proxyList tbody tr").live("dblclick",function(a){return a.preventDefault(),a.stopPropagation(),oTable.fnSelect(this),toggleselectedProxy(),editProxy(),!1}),isProxyTableInitialized=!0,$("#pageProxies").show()},placeDefaultToBottom=function(){var a,b=0,c=list.length;if("Default"!=list[c-1].data.name)for(;c>b;b++)if("Default"==list[b].data.name)return a=list.splice(b,1),list.push(a.pop()),void 0},oPatternTable=null,sProxyColor=null,selectedPattern=-1;!function(a){a.fn.extend({setChecked:function(a){return a?this.filter(":radio, :checkbox").attr("checked",!0):this.filter(":radio, :checkbox").removeAttr("checked")}})}(jQuery),$(document).ready(function(){$("#tabs").tabs({selected:1}),$("input[type='button']").button(),oPatternTable=$("#patternList").dataTable({bPaginate:!1,bLengthChange:!1,bFilter:!1,bSort:!1,bInfo:!1,bAutoWidth:!1,bUseRendered:!1,aaData:[],oLanguage:{sZeroRecords:""},aoColumns:[{sTitle:chrome.i18n.getMessage("enabled"),bUseRendered:!1,fnRender:function(a){return a.aData[a.iDataColumn]?"<img src='styles/images/bullet_tick.png'>":""}},{sTitle:chrome.i18n.getMessage("pattern_name")},{sTitle:chrome.i18n.getMessage("url_pattern")},{sTitle:chrome.i18n.getMessage("pattern_type")},{sTitle:chrome.i18n.getMessage("Whitelist_or_Blacklist")},{sTitle:chrome.i18n.getMessage("temporary"),bUseRendered:!1,fnRender:function(a){return a.aData[a.iDataColumn]?"<img src='styles/images/bullet_tick.png'>":""}}]}),$("#patternList tbody tr").live("click",function(){oPatternTable.fnSelect(this)}),$("#patternList tbody tr").live("dblclick",function(a){return a.preventDefault(),a.stopPropagation(),oPatternTable.fnSelect(this),editPattern(),!1}),$("#proxyColor").ColorPicker({color:"#000",onShow:function(a){return $(a).fadeIn(500),!1},onHide:function(a){return $(a).fadeOut(500),!1},onChange:function(a,b){sProxyColor="#"+b,$("#proxyColor div").css("backgroundColor",sProxyColor)}}).children("div").css({"background-color":"#000"})}),window.addEventListener("message",function(a){a.data&&alert(a.data.name)}),$(document).ready(function(){$("a#configureKeyboardLink").click(function(){chrome.tabs.create({url:"chrome://extensions/configureCommands"})})});var foxyProxy,settings,lastTabName;chrome.runtime.onMessage.addListener(function(a){if(a.settings){settings=a.settings;var b=lastTabName;"pageQuick"==b&&($("#enabledQA").setChecked(settings.enabledQA),$("#patternTemporaryQA").setChecked(settings.patternTemporaryQA),settings.enabledQA?$("#QASettingsContainer *").each(function(){$(this).prop("disabled",!1)}):$("#QASettingsContainer *").each(function(){$(this).attr("disabled","disabled")}),$("#patternTemplateQA").val(settings.patternTemplateQA),$("#patternUrlQA").val("http://fred:secret@mail.foo.com:8080/inbox/msg102.htm#subject?style=elegant").change(),$("#patternNameQA").val(settings.patternNameQA),$("#patternProxyQA *").remove(),$.each(list,function(a,b){b.data.readonly||$("#patternProxyQA").append($('<option value="'+a+'">'+b.data.name+"</option>"))}),$("#patternProxyQA option[value='"+settings.patternProxyQA+"']").attr("selected","selected"),$("input[name='patternWhitelistQA'][value='"+settings.patternWhitelistQA+"']").setChecked(!0),$("input[name='patternTypeQA'][value='"+settings.patternTypeQA+"']").setChecked(!0)),"pageGlobal"==b&&(foxyProxy.getFoxyProxyEdition&&"Basic"!=foxyProxy.getFoxyProxyEdition()?($("input[name='advancedMenuCheck']").attr("checked",settings.useAdvancedMenus),$("input[name='showContextMenuCheck']").attr("checked",settings.showContextMenu)):($("input[name='advancedMenuCheck']").hide(),$("input[name='showContextMenuCheck']").hide(),$("label[for='advancedMenuCheck']").hide(),$("label[for='showContextMenuCheck']").hide()),$("input[name='useChromeSyncCheck']").attr("checked",settings.useSyncStorage),$("input[name='animateIconCheck']").attr("checked",settings.animateIcon),$("input[name='showUpdatesCheck']").attr("checked",settings.showUpdates),$("input[name='usageOptOutCheck']").attr("checked",!settings.usageOptOut))}}),chrome.runtime.getBackgroundPage(function(a){foxyProxy=a.foxyProxy,foxyProxy.getSettings(),"Basic"!=foxyProxy.getFoxyProxyEdition()&&$("#tabQuick").show()}),$(document).ready(function(){$(".tabPage").hide(),$("#enabledQA").click(function(){return list.length<=1?(alert("You must have entered at least one proxy in order to use QuickAdd"),!1):(settings.enabledQA=$(this).is(":checked"),saveSettings(),settings.enabledQA?$("#QASettingsContainer *").each(function(){$(this).prop("disabled",!1)}):$("#QASettingsContainer *").each(function(){$(this).attr("disabled","disabled")}),void 0)}),$("#patternTemporaryQA").click(function(){settings.patternTemporaryQA=$(this).is(":checked"),saveSettings()}),$("#patternTemplateQA").keyup(function(){settings.patternTemplateQA=$(this).val(),saveSettings(),$("#patternResultQA").val(genPattern($("#patternUrlQA").val(),settings.patternTemplateQA))}),$("#patternUrlQA").change(function(){$("#patternResultQA").val(genPattern($(this).val(),settings.patternTemplateQA))}),$("#patternNameQA").change(function(){settings.patternNameQA=$(this).val(),saveSettings()}),$("input[name='patternWhitelistQA']").click(function(){settings.patternWhitelistQA=$(this).val(),saveSettings()}),$("input[name='patternTypeQA']").click(function(){settings.patternTypeQA=$(this).val(),saveSettings()}),$("#patternProxyQA, #dialogPatternProxyQA").change(function(){settings.patternProxyQA=$(this).val(),saveSettings()}),$("#proxyTypeDirect").click(function(){$(this).is(":checked")&&($(".proxyTypeManualGroup *").attr("disabled","disabled"),$(".proxyTypeAutoGroup *").attr("disabled","disabled"),$("#proxyDNS").attr("disabled","disabled"))}),$("#proxyTypeManual").click(function(){$(this).is(":checked")&&($(".proxyTypeManualGroup *").prop("disabled",!1),$(".proxyTypeAutoGroup *").attr("disabled","disabled"),$("#proxyDNS").prop("disabled",!1))}),$("#proxyTypeAuto").click(function(){$(this).is(":checked")&&($(".proxyTypeManualGroup *").attr("disabled","disabled"),$(".proxyTypeAutoGroup *").prop("disabled",!1),$("#proxyDNS").prop("disabled",!1))}),$(document.body).keydown(function(a){var b,c,d=$(".ui-dialog:visible");c=d.size()>0?$(".dataTables_wrapper > table",d).filter(":visible"):$(".dataTables_wrapper > table").filter(":visible");var e=c;38==a.keyCode&&(b=e.find("tbody tr.selected_row"),b.toggleClass("selected_row"),b.length&&!b.is(":first-child")?b.prev().toggleClass("selected_row").click():e.find("tbody tr:last").toggleClass("selected_row").click()),40==a.keyCode&&(b=e.find("tbody tr.selected_row"),b.toggleClass("selected_row"),b.length&&!b.is(":last-child")?b.next().toggleClass("selected_row").click():e.find("tbody tr:first").toggleClass("selected_row").click())}),$("#proxyModeGlobal").change(function(){var a=$("option:selected",this).val();foxyProxy.state=a}),$("input[name='advancedMenuCheck']").click(function(){foxyProxy.toggleAdvancedMenus()}),$("input[name='showContextMenuCheck']").click(function(){foxyProxy.toggleShowContextMenu()}),$("input[name='useChromeSyncCheck']").click(function(){foxyProxy.toggleSyncStorage()}),$("input[name='animateIconCheck']").click(function(){foxyProxy.toggleAnimateIcon()}),$("input[name='showUpdatesCheck']").click(function(){foxyProxy.toggleShowUpdates()}),$("input[name='usageOptOutCheck']").click(function(){foxyProxy.toggleUsageOptOut()}),$("#resetButton").click(function(){confirm("Are you sure you want to reload all settings?")&&foxyProxy.reloadSettings()}),$("#resetDefaultsButton").click(function(){confirm("This will reset all settings and remove any proxies that were added! Are you sure you want to reset?")&&foxyProxy.resetToDefaults()}),onTabShow("")});