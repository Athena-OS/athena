pkgname=ians
pkgver=65.eb15373
pkgrel=1
groups=('athena' 'athena-networking')
pkgdesc='A Python-based hacking toolset.'
arch=('any')
url='https://github.com/giovanni-iannaccone/ians'
license=('GPL3')
depends=('python-lxml' 'python-requests' 'python-rich' 'python-scapy')
makedepends=('git')
source=("git+https://github.com/giovanni-iannaccone/$pkgname.git")
sha512sums=('SKIP')

pkgver() {
  cd $pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

package() {
  cd $pkgname

  install -dm 755 "$pkgdir/usr/share/$pkgname"
  install -dm 755 "$pkgdir/usr/share/$pkgname/src"
  install -dm 755 "$pkgdir/usr/share/$pkgname/utils"
  install -dm 755 "$pkgdir/usr/bin"
  install -Dm 755 -t "$pkgdir/usr/share/$pkgname/" "setup.sh" "update.sh" "$pkgname.py"
  install -Dm 755 -t "$pkgdir/usr/share/$pkgname/src/" "src/arper.py" "src/bruteforce.py" \
    "src/client_ssh.py" "src/ddos.py" "src/directory_bruter.py" "src/game.py" "src/image_sniffer.py" \
    "src/mail_sniffer.py" "src/mapper.py" "src/port_scan.py" "src/server_ssh.py" "src/sniffer.py" \
    "src/trojan_creation.py" "src/user_finder.py"
  install -Dm 755 -t "$pkgdir/usr/share/$pkgname/utils/" "utils/common_ports.json" "utils/little_dictionary.txt" \
    "utils/view.jpg"

  cat > "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
cd /usr/share/$pkgname/
python $pkgname.py "\$@"
EOF

  chmod a+x "$pkgdir/usr/bin/$pkgname"
}
