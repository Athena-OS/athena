# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=fsnoop
pkgver=3.5.r0.g1e90751
pkgrel=1
groups=('role-redteamer' 'athena' 'athena-scanner')
pkgdesc='A tool to monitor file operations on GNU/Linux systems by using the Inotify mechanism. Its primary purpose is to help detecting file race condition vulnerabilities and since version 3, to exploit them with loadable DSO modules (also called "payload modules" or "paymods").'
arch=('x86_64' 'aarch64')
url='https://github.com/v14dz/fsnoop'
license=('Beer-Ware')
depends=('glibc')
source=("git+https://github.com/v14dz/$pkgname")
sha512sums=('SKIP')

pkgver() {
  cd $pkgname

  git describe --long --tags | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
}

build() {
  cd $pkgname

  make
}

package() {
  cd $pkgname

  install -Dm 755 $pkgname "$pkgdir/usr/bin/$pkgname"
  install -Dm 644 -t "$pkgdir/usr/share/doc/$pkgname/" README.md todo.txt \
    ChangeLog
}