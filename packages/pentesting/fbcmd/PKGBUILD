# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=fbcmd
pkgver=190.159efc0
pkgrel=1
pkgdesc='A Command Line Interface (CLI) for Facebook'
arch=('any')
url='https://github.com/dtompkins/fbcmd'
license=('GPL-3.0-or-later')
depends=('php')
source=("git+https://github.com/dtompkins/$pkgname.git"
        'php.ini')
sha512sums=('SKIP'
            'c94c78382df6cef8798852f826553875006d6daeb3bff346ababc797f56dfe34d22b78f354d54dbaa3c8a417b030ab6671b7e9d9cfd9ba2ba96d9c47a00c639f')

pkgver() {
  cd $pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

package() {
  cd $pkgname

  install -dm 755 "$pkgdir/usr/bin"

  install -Dm 755 fbcmd.php ../php.ini -t "$pkgdir/usr/share/$pkgname"
  install -Dm 644 filelist.txt readme.txt -t  "$pkgdir/usr/share/doc/$pkgname"

  rm filelist.txt readme.txt

  cp -a * "$pkgdir/usr/share/$pkgname/"

  cat >> "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
exec php -c /usr/share/$pkgname/php.ini /usr/share/$pkgname/fbcmd.php "\$@"
EOF

  chmod +x "$pkgdir/usr/bin/$pkgname"
}

