# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=burpsuite
pkgver=2025.2.1
pkgrel=1
epoch=1
groups=('role-bountyhunter' 'role-student' 'role-webpentester' 'role-redteamer'
        'role-network' 'athena' 'athena-webapp' 'athena-proxy' 'athena-scanner'
        'athena-fuzzer')
pkgdesc='An integrated platform for attacking web applications (community edition) + SHELLING plugin.'
arch=('any')
url='https://portswigger.net/burp/releases'
license=('custom:unknown')
depends=('java-runtime>=17' 'giflib' 'libxext' 'libxrender' 'libxtst')
makedepends=('git')
noextract=("$pkgname.jar")
source=("$pkgname.jar::https://portswigger.net/burp/releases/download?product=community&version=$pkgver&type=jar"
        'LICENSE'
        "$pkgname.desktop"
        'icon64.png'
        'git+https://github.com/PortSwigger/command-injection-attacker.git')
sha512sums=('d6d92f1e9664f8ee01a850639484a02f46776c2b121f3708072a94698185af77ca5736e86f9ce6469b1a0b3924ea1c5c307a63f6ae1a0f5cf053064ee5206056'
            '07f646ce79e4e259c8da4a16ecd9b0149f09cd047ab42bfb758dc1cd4871710866e4dae6cda572f96fb49d0b156e64dd7b0a78904d9d367d41136214de5488a2'
            '7ef079d441d36a713f0b36324a09566c3ede974084540355576107d0425bbc5413b47dd5130d221f99ec8ee593c18772879f793787902799ff182a4512a8737f'
            '928083e0189ce50304c4b32f8f6ef56be79881090bffdaddb5e990a59186ed2596c03293255693d488a47519e6da4e969e74e9bfe22a0f6ca53491a4e0749575'
            'SKIP')

package() {
  install -dm 755 "$pkgdir/usr/bin"
  install -dm 755 "$pkgdir/usr/share/"{applications,pixmaps,${pkgname},licenses/${pkgname}}

  install -Dm 644 "$pkgname.jar" "$pkgdir/usr/share/$pkgname/$pkgname.jar"
  install -Dm 644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
  install -Dm 644 "$pkgname.desktop" "$pkgdir/usr/share/applications/"
  install -Dm 644 icon64.png "$pkgdir/usr/share/pixmaps/$pkgname.png"

  cat > "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
exec \$JAVA_HOME/bin/java -jar /usr/share/$pkgname/$pkgname.jar "\$@"
EOF

  chmod +x "$pkgdir/usr/bin/$pkgname"

  # SHELLING plugin
  cd command-injection-attacker
  install -Dm 644 SHELLING.jar "$pkgdir/usr/share/$pkgname/SHELLING.jar"
}

