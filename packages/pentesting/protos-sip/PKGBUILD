# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=protos-sip
pkgver=29.29ad42a
pkgrel=1
pkgdesc='SIP test suite.'
groups=('athena' 'athena-voip')
arch=('x86_64' 'aarch64')
url='https://gitlab.com/kalilinux/packages/protos-sip'
license=('GPL-2.0-or-later')
depends=('java-runtime-headless')
noextract=('c07-sip-r2.jar')
source=("git+https://gitlab.com/kalilinux/packages/$pkgname.git")
sha512sums=('SKIP')

pkgver() {
  cd $pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

package() {
  cd $pkgname
  
  install -dm 755 "$pkgdir/usr/bin"

  install -Dm 644 c07-sip-r2.jar "$pkgdir/usr/share/$pkgname/c07-sip-r2.jar"

  cat > "$pkgdir/usr/bin/$pkgname" << EOF
#!/bin/sh
cd /usr/share/$pkgname
exec java -jar c07-sip-r2.jar "\$@"
EOF

  chmod +x "$pkgdir/usr/bin/$pkgname"
}

