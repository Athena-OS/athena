# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=kraken
pkgver=37.02e8c29
pkgrel=1
groups=('athena' 'athena-crypto' 'athena-mobile' 'athena-hardware')
pkgdesc='A project to encrypt A5/1 GSM signaling using a Time/Memory Tradeoff Attack.'
arch=('x86_64' 'aarch64')
url='https://opensource.srlabs.de/projects/a51-decrypt'
license=('GPL-3.0-or-later')
depends=('gcc-libs')
makedepends=('git')
source=("git+https://github.com/joswr1ght/$pkgname.git"
        'build.patch')
sha512sums=('SKIP'
            'cb9de935b843b15e5e147202d420629789f3d4a13e5a1f65c95d427bd02bc02956e8089f07fb3bb49325a8ddaf47a463b2cf1d8d97d27beaea5136844943e97e')

pkgver() {
  cd $pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

prepare() {
  cd "$pkgname/Kraken"

  patch -p1 -i "$srcdir/build.patch"
}

build() {
  cd "$pkgname/Kraken"

  ./build.sh
}

package () {
  cd "$pkgname/Kraken"

  install -Dm 755 $pkgname "$pkgdir/usr/bin/$pkgname"
}

