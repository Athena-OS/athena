# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=packerid
pkgver=16.bc54e6d
pkgrel=1
groups=('athena' 'athena-binary' 'athena-packer' 'athena-reversing')
pkgdesc='Script which uses a PEiD database to identify which packer (if any) is being used by a binary.'
arch=('any')
license=('custom:unknown')
url='https://github.com/sooshie/packerid'
depends=('python2' 'python2-capstone' 'python2-pefile')
source=("git+https://github.com/sooshie/$pkgname.git")
sha512sums=('SKIP')

pkgver() {
  cd $pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

prepare(){
  cd $pkgname

  sed -i 's|/usr/bin/python$|/usr/bin/python2|' "$pkgname.py"
  sed -i 's|/usr/local/etc|/usr/share/packerid|' "$pkgname.py"
}

package() {
  cd $pkgname
  
  install -Dm 755 "$pkgname.py" "$pkgdir/usr/bin/$pkgname"
  install -Dm 644 userdb.txt "$pkgdir/usr/share/$pkgname/userdb.txt"
}

