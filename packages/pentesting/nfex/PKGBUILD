# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=nfex
pkgver=2.5
pkgrel=4
groups=('athena' 'athena-forensic' 'athena-networking')
pkgdesc='A tool for extracting files from the network in real-time or post-capture from an offline tcpdump pcap savefile.'
arch=('x86_64' 'aarch64')
url='https://code.google.com/p/nfex/'
license=('GPL-2.0-or-later')
makedepends=('flex' 'libpcap' 'libnet')
source=("https://storage.googleapis.com/google-code-archive-source/v2/code.google.com/nfex/source-archive.zip"
        "fix-make-fcommon.patch")
sha512sums=('fc9c0b886b2505647166cd25657741b8cd8a45bc2aa80b979a2b9935355d664069b343f78929a1d32fd9fa5fd7aa25a641299e9badc8774dda48b6d6b09fb0f9'
            '991713822d51bb2bf28be4c5b0c7f495968f7ec7c59092fde7e96ceb9c2c5f0351714b54d341e084dcd703fa1db15dc4d662b0c224fb7167e01b613ffaae5986')

prepare() {
  cd "$pkgname/trunk"

  patch -p1 < "$srcdir/fix-make-fcommon.patch"
}

build() {
  cd "$pkgname/trunk"

  ./configure --prefix=/usr

  make
}

package() {
  cd "$pkgname/trunk"

  install -Dm 755 "src/$pkgname" "$pkgdir/usr/bin/$pkgname"
}
