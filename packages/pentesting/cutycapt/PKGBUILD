# Credits BlackArch ( https://www.blackarch.org/ ).
# See COPYING for license details.

pkgname=cutycapt
pkgver=12.bea8c78
pkgrel=1
epoch=3
groups=('athena' 'athena-recon')
pkgdesc="A Qt and WebKit based command-line utility that captures WebKit's rendering of a web page."
arch=('x86_64' 'aarch64')
url='http://cutycapt.sourceforge.net/'
license=('GPL-1.0-or-later')
depends=('qt5-base' 'qt5-webkit' 'qt5-svg')
makedepends=('git' 'dos2unix')
source=("$pkgname::git+https://github.com/hoehrmann/CutyCapt.git"
        'fix-qt5-printsupport.patch')
sha512sums=('SKIP'
            '63e0ad059d75ceceacaa41ebf348eddd08d1684c9bface06ab49fd2ca888fb704a92d636bbf8e4f27b1e19bbf9e0fc32bd58f55841fca933d7a939cd98f59b92')

pkgver() {
  cd $pkgname

  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

prepare() {
  cd "$pkgname"

  patch -p1 < "${srcdir}/fix-qt5-printsupport.patch"
  dos2unix *
}

build() {
  cd "$pkgname"

  qmake-qt5 CutyCapt.pro
  make
}

package() {
  cd "$pkgname"

  install -Dm 755 CutyCapt "$pkgdir/usr/bin/$pkgname"
}

